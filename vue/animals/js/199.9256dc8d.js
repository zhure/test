"use strict";(self["webpackChunkstray_animal_rescue_system"]=self["webpackChunkstray_animal_rescue_system"]||[]).push([[199],{7111:function(e,a,t){t.d(a,{Z:function(){return c}});var l=t(6252);const r={class:"wrap"},s=(0,l._)("div",{id:"container"},null,-1);function n(e,a,t,n,o,i){const d=(0,l.up)("location"),u=(0,l.up)("el-icon");return(0,l.wg)(),(0,l.iD)("div",r,[s,(0,l.Wm)(u,{size:"large",style:{"margin-left":"10px",cursor:"pointer"},onClick:i.getLocate},{default:(0,l.w5)((()=>[(0,l.Wm)(d)])),_:1},8,["onClick"])])}var o=t(7515),i=t.n(o),d={name:"Locate",data(){return{address:""}},mounted(){this.createMap()},created(){},methods:{getLocate(){this.$emit("childFn",this.address)},createMap(){var e=this,a=new(i().Map)("container"),t=new(i().Point)(116.331398,39.897445);a.centerAndZoom(t,12);var l=new(i().Geocoder),r=new(i().Geolocation);r.getCurrentPosition((function(t){if(this.getStatus()===BMAP_STATUS_SUCCESS){var r=new(i().Marker)(t.point);a.addOverlay(r),a.panTo(t.point),console.log("您的位置："+t.point.lng+","+t.point.lat);var s=t.point;l.getLocation(s,(function(a){var t=a.addressComponents;e.address=t.province+t.city+t.district+t.street+t.streetNumber}))}else console.log("failed"+this.getStatus())}),{enableHighAccuracy:!0})}}},u=t(3744);const m=(0,u.Z)(d,[["render",n]]);var c=m},7199:function(e,a,t){t.r(a),t.d(a,{default:function(){return v}});var l=t(6252),r=t(3577);const s=e=>((0,l.dD)("data-v-9d3c08a0"),e=e(),(0,l.Cn)(),e),n={class:"custom-tabs-label"},o=s((()=>(0,l._)("span",null,"发布领养信息",-1))),i=["src"],d={style:{"margin-left":"10px"}},u=(0,l.Uk)("重 置"),m=(0,l.Uk)("发 布");function c(e,a,t,s,c,p){const g=(0,l.up)("calendar"),f=(0,l.up)("el-icon"),h=(0,l.up)("el-option"),w=(0,l.up)("el-select"),_=(0,l.up)("el-form-item"),v=(0,l.up)("Plus"),b=(0,l.up)("el-upload"),y=(0,l.up)("el-input"),W=(0,l.up)("Locate"),k=(0,l.up)("el-button"),C=(0,l.up)("el-form"),U=(0,l.up)("el-tab-pane"),A=(0,l.up)("el-tabs");return(0,l.wg)(),(0,l.j4)(A,{type:"border-card",class:"demo-tabs"},{default:(0,l.w5)((()=>[(0,l.Wm)(U,null,{label:(0,l.w5)((()=>[(0,l._)("span",n,[(0,l.Wm)(f,null,{default:(0,l.w5)((()=>[(0,l.Wm)(g)])),_:1}),o])])),default:(0,l.w5)((()=>[(0,l.Wm)(C,{ref:"form",model:c.form,rules:c.rules,size:"normal","label-width":"100px"},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{label:"动物种类",prop:"animalId"},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{modelValue:c.form.animalId,"onUpdate:modelValue":a[0]||(a[0]=e=>c.form.animalId=e),class:"m-2",placeholder:"Select"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(c.animals,(e=>((0,l.wg)(),(0,l.j4)(h,{key:e.id,label:e.type,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(_,{label:"动物图片",prop:"img"},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{ref:"adoptImg",class:"avatar-uploader",action:"http://localhost:9090/files/upload","show-file-list":!1,"on-success":p.handleAvatarSuccess,"before-upload":p.beforeAvatarUpload},{default:(0,l.w5)((()=>[c.imageUrl?((0,l.wg)(),(0,l.iD)("img",{key:0,src:c.form.img,class:"avatar"},null,8,i)):((0,l.wg)(),(0,l.j4)(f,{key:1,class:"avatar-uploader-icon"},{default:(0,l.w5)((()=>[(0,l.Wm)(v)])),_:1}))])),_:1},8,["on-success","before-upload"])])),_:1}),(0,l.Wm)(_,{label:"名字",prop:"name"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{modelValue:c.form.name,"onUpdate:modelValue":a[1]||(a[1]=e=>c.form.name=e),style:{width:"70%"}},null,8,["modelValue"])])),_:1}),(0,l.Wm)(_,{label:"描述",prop:"detail"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{modelValue:c.form.detail,"onUpdate:modelValue":a[2]||(a[2]=e=>c.form.detail=e),type:"textarea"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(_,{label:"住址",prop:"address"},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{onChildFn:p.parentFn},null,8,["onChildFn"]),(0,l._)("span",d,(0,r.zw)(c.form.address),1)])),_:1}),(0,l.Wm)(_,null,{default:(0,l.w5)((()=>[(0,l.Wm)(k,{type:"warning",plain:"",onClick:p.reset},{default:(0,l.w5)((()=>[u])),_:1},8,["onClick"]),(0,l.Wm)(k,{type:"warning",onClick:p.save},{default:(0,l.w5)((()=>[m])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})}var p=t(4471),g=t(7111),f=t(610),h={name:"ReleaseAdoption",components:{Locate:g.Z},data(){return{animals:[],form:{},rules:{img:[{required:!0,message:"请上传图片",trigger:"blur"}],name:[{required:!0,message:"请输入名称",trigger:"blur"}],detail:[{required:!0,message:"请输入描述",trigger:"blur"}],animalId:[{required:!0,message:"请选择动物种类",trigger:"change"}],address:[{required:!0,message:"请定位住址",trigger:"blur"}]},toAddress:!1,imageUrl:!1}},mounted(){this.getAnimal()},methods:{async getAnimal(){await p.Z.get("animal",this.isPass).then((e=>{this.animals=e.data}))},beforeAvatarUpload:e=>{let a=["image/jpeg","image/jpg","image/png"];const t=a.includes(e.type);return t?!(e.size/1024/1024>2)||(f.z8.error("图片大小不能超过2MB!"),!1):(f.z8.error("上传图片只能是 JPG、JPEG、PNG 格式!"),!1)},handleAvatarSuccess(e){this.form.img=e.data,this.imageUrl=!0},parentFn(e){this.form.address=e},save(){this.form.userId=JSON.parse(sessionStorage.getItem("user")).id;this.$refs["form"].validate((e=>{e&&p.Z.post("/adoption",this.form).then((e=>{"0"===e.code?this.$message({type:"success",message:"发布成功，请耐心等待审核"}):this.$message({type:"error",message:e.msg})}))}))},reset(){""!==this.form.img&&this.$refs["adoptImg"].clearFiles(),this.imageUrl=!1,this.form={}}}},w=t(3744);const _=(0,w.Z)(h,[["render",c],["__scopeId","data-v-9d3c08a0"]]);var v=_}}]);
//# sourceMappingURL=199.9256dc8d.js.map