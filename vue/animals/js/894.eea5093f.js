"use strict";(self["webpackChunkstray_animal_rescue_system"]=self["webpackChunkstray_animal_rescue_system"]||[]).push([[894],{894:function(e,s,a){a.r(s),a.d(s,{default:function(){return $}});var t=a(6252),i=a(3577);const n=e=>((0,t.dD)("data-v-7d0fff6b"),e=e(),(0,t.Cn)(),e),l={style:{padding:"10px"}},m={key:0,style:{margin:"10px 0"}},o={key:1,style:{margin:"10px 0"}},p=n((()=>(0,t._)("span",null,"用户请求添加：",-1))),d={style:{margin:"0 50px 0 10px","font-size":"18px",color:"#99a9bf"}},r={style:{margin:"10px 0"}},u=(0,t.Uk)("新增"),c={key:0},f={key:0},h=(0,t.Uk)("到底了"),g={key:1},w=(0,t.Uk)("下一条"),y={style:{display:"block",padding:"20px"}},_={class:"title"},k=["src"],v={style:{"margin-left":"10px"}},C={class:"nick"},W={class:"time"},x=["innerHTML"];function b(e,s,a,n,b,Z){const z=(0,t.up)("el-button"),D=(0,t.up)("el-popconfirm"),L=(0,t.up)("el-col"),$=(0,t.up)("el-input"),A=(0,t.up)("el-row"),q=(0,t.up)("el-card");return(0,t.wg)(),(0,t.iD)("div",l,[(0,t.Wm)(A,null,{default:(0,t.w5)((()=>[(0,t.Wm)(L,{span:19},{default:(0,t.w5)((()=>[void 0===b.animal.id?((0,t.wg)(),(0,t.iD)("div",m,"暂未有用户请求添加")):(0,t.kq)("",!0),void 0!==b.animal.id?((0,t.wg)(),(0,t.iD)("div",o,[p,(0,t._)("span",d,(0,i.zw)(b.animal.type),1),(0,t.Wm)(D,{title:"通过后以下帖子也将通过？",onConfirm:Z.approved},{reference:(0,t.w5)((()=>[(0,t.Wm)(z,{type:"success",icon:b.Check,size:"normal",plain:""},null,8,["icon"])])),_:1},8,["onConfirm"]),(0,t.Wm)(D,{title:"确定不通过？将被删除，相应帖子将被删除",onConfirm:Z.fail},{reference:(0,t.w5)((()=>[(0,t.Wm)(z,{type:"danger",icon:b.Close,size:"normal",plain:""},null,8,["icon"])])),_:1},8,["onConfirm"])])):(0,t.kq)("",!0)])),_:1}),(0,t.Wm)(L,{span:5},{default:(0,t.w5)((()=>[(0,t._)("div",r,[(0,t.Wm)($,{modelValue:b.newAnimal.type,"onUpdate:modelValue":s[0]||(s[0]=e=>b.newAnimal.type=e),placeholder:"请输入动物种类",style:{width:"70%"},clearable:""},null,8,["modelValue"]),(0,t.Wm)(D,{title:"确定要新增动物种类？",onConfirm:Z.submit},{reference:(0,t.w5)((()=>[(0,t.Wm)(z,{style:{"margin-left":"5px"},type:"primary"},{default:(0,t.w5)((()=>[u])),_:1})])),_:1},8,["onConfirm"])])])),_:1})])),_:1}),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(b.posts,((e,s)=>((0,t.wg)(),(0,t.j4)(q,{class:"detail",shadow:"never"},{default:(0,t.w5)((()=>[s===b.num?((0,t.wg)(),(0,t.iD)("div",c,[(0,t.Wm)(A,null,{default:(0,t.w5)((()=>[(0,t.Wm)(L,{span:19},{default:(0,t.w5)((()=>[b.num===b.postLen-1?((0,t.wg)(),(0,t.iD)("div",f,[(0,t.Wm)(z,{disabled:""},{default:(0,t.w5)((()=>[h])),_:1})])):(0,t.kq)("",!0),b.num!==b.postLen-1?((0,t.wg)(),(0,t.iD)("div",g,[(0,t.Wm)(z,{onClick:Z.next},{default:(0,t.w5)((()=>[w])),_:1},8,["onClick"])])):(0,t.kq)("",!0)])),_:1}),(0,t.Wm)(L,{span:5},{default:(0,t.w5)((()=>[(0,t.Wm)(D,{title:"确定不通过？将被删除",onConfirm:s=>Z.delete_post(e.id)},{reference:(0,t.w5)((()=>[(0,t.Wm)(z,{type:"danger",icon:b.Close,size:"small",plain:""},null,8,["icon"])])),_:2},1032,["onConfirm"])])),_:2},1024)])),_:2},1024),(0,t._)("div",y,[(0,t._)("span",_,(0,i.zw)(e.title),1)]),(0,t.Wm)(A,null,{default:(0,t.w5)((()=>[(0,t.Wm)(L,{span:1,offset:1},{default:(0,t.w5)((()=>[(0,t._)("img",{class:"avatar",src:e.user["headImg"],alt:"头像"},null,8,k)])),_:2},1024),(0,t.Wm)(L,{span:21},{default:(0,t.w5)((()=>[(0,t._)("div",v,[(0,t._)("span",C,(0,i.zw)(e.user["nickName"]),1),(0,t._)("span",W,(0,i.zw)(e.time),1)])])),_:2},1024)])),_:2},1024),(0,t._)("div",{style:{margin:"25px"},innerHTML:e.content},null,8,x)])):(0,t.kq)("",!0)])),_:2},1024)))),256))])}var Z=a(4471),z={name:"AnimalAudit",data(){return{animal:{},posts:[],postLen:0,num:0,newAnimal:{},Check:"Check",Close:"Close"}},created(){this.load()},methods:{async load(){await Z.Z.get("/animal",{params:{isPass:0}}).then((e=>{e.data.length>0&&(this.animal=e.data[0])})),void 0!==this.animal.id&&await Z.Z.get("/post/animal/"+this.animal.id).then((e=>{this.posts=e.data,this.postLen=e.data.length}))},submit(){this.newAnimal.isPass=1,Z.Z.post("/animal",this.newAnimal).then((e=>{"0"===e.code?this.$message({type:"success",message:"添加成功"}):this.$message({type:"error",message:e.msg})}))},async approved(){for(const e of this.posts){let s=e;s.isPass=1,await Z.Z.put("/post",s)}this.animal.isPass=1,await Z.Z.put("/animal",this.animal).then((e=>{"0"===e.code?(this.$message({type:"success",message:"审核成功"}),this.animal={},this.posts=[],this.postLen=0,this.load()):this.$message({type:"error",message:e.msg})}))},async fail(){for(const e of this.posts)await Z.Z["delete"]("/post/"+e.id);await Z.Z["delete"]("/animal/"+this.animal.id).then((e=>{"0"===e.code?(this.$message({type:"success",message:"审核成功"}),this.posts=[],this.postLen=0,this.animal={},this.load()):this.$message({type:"error",message:e.msg})}))},next(){this.num++},delete_post(e){Z.Z["delete"]("/post/"+e).then((e=>{"0"===e.code?(this.$message({type:"success",message:"删除成功"}),this.load()):this.$message({type:"error",message:e.msg})}))}}},D=a(3744);const L=(0,D.Z)(z,[["render",b],["__scopeId","data-v-7d0fff6b"]]);var $=L}}]);
//# sourceMappingURL=894.eea5093f.js.map