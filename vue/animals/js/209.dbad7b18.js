"use strict";(self["webpackChunkstray_animal_rescue_system"]=self["webpackChunkstray_animal_rescue_system"]||[]).push([[209],{2209:function(e,t,s){s.r(t),s.d(t,{default:function(){return de}});var a=s(6252),l=s(3577),i=s(9963),o=s(1517),n=s(1074),r=s(5123),d=s(4198);const u=e=>((0,a.dD)("data-v-e188cfea"),e=e(),(0,a.Cn)(),e),m=u((()=>(0,a._)("div",null,[(0,a._)("img",{class:"cats",src:o,alt:"一群卡通喵"})],-1))),p=["src"],c={style:{"font-size":"25px"}},g=u((()=>(0,a._)("div",{style:{flex:"1"}},null,-1))),h={style:{"font-size":"10px"}},f={style:{"font-size":"13px"}},w=(0,a.Uk)("关注"),_=(0,a.Uk)("取消关注"),v={style:{display:"block","margin-top":"25px"}},y=(0,a.Uk)("关注"),k={style:{"font-size":"16px","margin-right":"10px",padding:"2px",color:"#999999"}},W=(0,a.Uk)("粉丝"),b={style:{"font-size":"16px","margin-right":"10px",padding:"2px",color:"#999999"}},x=["onClick","src"],F=["onClick"],U=(0,a.Uk)("取消关注"),C=["onClick","src"],V=["onClick"],z=u((()=>(0,a._)("img",{style:{width:"130px"},src:n,alt:"一排猫爪印"},null,-1))),I={key:0},D=u((()=>(0,a._)("img",{style:{width:"37px"},src:r,alt:"一只爪印"},null,-1))),$=u((()=>(0,a._)("div",{style:{flex:"1"}},null,-1))),S=(0,a.Uk)("私信"),A={key:1,class:"aside"},N=u((()=>(0,a._)("img",{src:r,alt:"一只爪印"},null,-1))),Z=u((()=>(0,a._)("div",{style:{flex:"1"}},null,-1))),M=(0,a.Uk)("个人动态信息"),q=(0,a.Uk)("编辑个人信息"),J=(0,a.Uk)("发布交流贴子"),O=(0,a.Uk)("发布领养信息"),R=(0,a.Uk)("查询消息记录"),j={key:1,class:"vet"},E=u((()=>(0,a._)("span",{style:{color:"#9d6017"}},"医生名片",-1))),L=["src"],H=(0,a.Uk)("保存"),P=(0,a.Uk)("取消");function Y(e,t,s,o,n,r){const u=(0,a.up)("el-col"),Y=(0,a.up)("female"),G=(0,a.up)("el-icon"),T=(0,a.up)("male"),B=(0,a.up)("sugar"),K=(0,a.up)("el-button"),Q=(0,a.up)("el-row"),X=(0,a.up)("el-divider"),ee=(0,a.up)("el-dialog"),te=(0,a.up)("el-card"),se=(0,a.up)("el-popover"),ae=(0,a.up)("el-input"),le=(0,a.up)("router-link"),ie=(0,a.up)("edit"),oe=(0,a.up)("el-form-item"),ne=(0,a.up)("el-form"),re=(0,a.up)("VetRegister"),de=(0,a.up)("router-view");return(0,a.wg)(),(0,a.iD)(a.HY,null,[m,(0,a.Wm)(te,{class:"head",shadow:"never"},{default:(0,a.w5)((()=>[(0,a.Wm)(Q,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{span:3},{default:(0,a.w5)((()=>[(0,a._)("img",{class:"avatar",src:n.form.headImg,alt:"用户头像"},null,8,p)])),_:1}),(0,a.Wm)(u,{class:"info",span:14},{default:(0,a.w5)((()=>[(0,a._)("span",null,[(0,a._)("span",c,(0,l.zw)(n.form.nickName),1),(0,a.wy)((0,a.Wm)(G,{color:"pink"},{default:(0,a.w5)((()=>[(0,a.Wm)(Y)])),_:1},512),[[i.F8,"女"===n.form.sex]]),(0,a.wy)((0,a.Wm)(G,{color:"blue"},{default:(0,a.w5)((()=>[(0,a.Wm)(T)])),_:1},512),[[i.F8,"男"===n.form.sex]])]),g,(0,a._)("span",h,"用户名： "+(0,l.zw)(n.form.username),1),(0,a._)("span",f,[(0,a.Wm)(G,{color:"orange"},{default:(0,a.w5)((()=>[(0,a.Wm)(B)])),_:1}),(0,a.Uk)(" "+(0,l.zw)(n.form.birthday),1)])])),_:1}),(0,a.Wm)(u,{span:3},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(K,{onClick:r.follow,size:"normal",style:{"margin-top":"35px"},type:"warning",plain:""},{default:(0,a.w5)((()=>[w])),_:1},8,["onClick"]),[[i.F8,!n.isAttention&&!n.isMe]]),(0,a.wy)((0,a.Wm)(K,{onClick:r.notFollow,size:"normal",style:{"margin-top":"35px"}},{default:(0,a.w5)((()=>[_])),_:1},8,["onClick"]),[[i.F8,n.isAttention&&!n.isMe]]),(0,a._)("div",v,[(0,a.Wm)(K,{onClick:t[0]||(t[0]=e=>n.showAttentions=!0),type:"text",size:"normal",style:{color:"rosybrown"}},{default:(0,a.w5)((()=>[y])),_:1}),(0,a._)("span",k,(0,l.zw)(n.attention_length),1),(0,a.Wm)(K,{onClick:t[1]||(t[1]=e=>n.showFans=!0),type:"text",size:"normal",style:{color:"rosybrown"}},{default:(0,a.w5)((()=>[W])),_:1}),(0,a._)("span",b,(0,l.zw)(n.fan_length),1)]),(0,a._)("div",null,[(0,a.Wm)(ee,{modelValue:n.showAttentions,"onUpdate:modelValue":t[2]||(t[2]=e=>n.showAttentions=e),title:"关注列表",width:"30%",center:""},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.attentions,(e=>((0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(Q,{align:"center"},{default:(0,a.w5)((()=>[(0,a.Wm)(u,{span:5},{default:(0,a.w5)((()=>[(0,a._)("img",{onClick:t=>r.toUser(e.user["id"]),src:e.user["headImg"],class:"min-avatar"},null,8,x)])),_:2},1024),(0,a.Wm)(u,{span:13},{default:(0,a.w5)((()=>[(0,a._)("span",{onClick:t=>r.toUser(e.user["id"]),style:{cursor:"pointer",position:"relative",top:"12px","font-size":"18px"}},(0,l.zw)(e.user["nickName"]),9,F)])),_:2},1024),(0,a.Wm)(u,{span:6},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(K,{onClick:t=>r.notFollowIt(e.id),style:{"margin-top":"10px"},size:"normal",plain:""},{default:(0,a.w5)((()=>[U])),_:2},1032,["onClick"]),[[i.F8,n.isMe]])])),_:2},1024)])),_:2},1024),(0,a.Wm)(X)])))),256))])),_:1},8,["modelValue"]),(0,a.Wm)(ee,{modelValue:n.showFans,"onUpdate:modelValue":t[3]||(t[3]=e=>n.showFans=e),title:"粉丝列表",width:"35%",center:""},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.fans,(e=>((0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(Q,null,{default:(0,a.w5)((()=>[(0,a.Wm)(u,{span:5},{default:(0,a.w5)((()=>[(0,a._)("img",{onClick:t=>r.toUser(e.user["id"]),src:e.user["headImg"],class:"min-avatar"},null,8,C)])),_:2},1024),(0,a.Wm)(u,{span:13},{default:(0,a.w5)((()=>[(0,a._)("span",{onClick:t=>r.toUser(e.user["id"]),style:{cursor:"pointer",position:"relative",top:"12px","font-size":"18px"}},(0,l.zw)(e.user["nickName"]),9,V)])),_:2},1024),(0,a.Wm)(u,{span:6})])),_:2},1024),(0,a.Wm)(X)])))),256))])),_:1},8,["modelValue"])])])),_:1}),(0,a.Wm)(u,{span:4},{default:(0,a.w5)((()=>[z])),_:1})])),_:1})])),_:1}),(0,a.Wm)(Q,null,{default:(0,a.w5)((()=>[(0,a.Wm)(te,{class:"vet-info",shadow:"never"},{default:(0,a.w5)((()=>[n.isMe?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",I,[D,$,(0,a.Wm)(se,{placement:"top-start",width:100,trigger:"hover",content:"点我私信,喵~"},{reference:(0,a.w5)((()=>[(0,a._)("img",{style:{width:"90%","margin-top":"60px",cursor:"pointer"},onClick:t[4]||(t[4]=e=>n.toLetter=!n.toLetter),src:d,alt:"一只卡通猫"})])),_:1}),n.toLetter?((0,a.wg)(),(0,a.j4)(te,{key:0,shadow:"hover",header:"有什么想对我说的？",style:{color:"#da9f6c"}},{default:(0,a.w5)((()=>[(0,a.Wm)(ae,{modelValue:n.message.content,"onUpdate:modelValue":t[5]||(t[5]=e=>n.message.content=e),autosize:{minRows:2,maxRows:9},type:"textarea",placeholder:"输入你想对我说的话"},null,8,["modelValue"]),(0,a.Wm)(K,{onClick:r.submit,type:"warning",plain:""},{default:(0,a.w5)((()=>[S])),_:1},8,["onClick"])])),_:1})):(0,a.kq)("",!0)])),n.isMe?((0,a.wg)(),(0,a.iD)("div",A,[N,Z,(0,a._)("p",null,[(0,a.Wm)(le,{to:"/userinfo/dynamic"},{default:(0,a.w5)((()=>[M])),_:1})]),(0,a._)("p",null,[(0,a.Wm)(le,{to:"/userinfo/editor"},{default:(0,a.w5)((()=>[q])),_:1})]),(0,a._)("p",null,[(0,a.Wm)(le,{to:"/userinfo/write_posts"},{default:(0,a.w5)((()=>[J])),_:1})]),(0,a._)("p",null,[(0,a.Wm)(le,{to:"/userinfo/release_adoption"},{default:(0,a.w5)((()=>[O])),_:1})]),(0,a._)("p",null,[(0,a.Wm)(le,{to:"/userinfo/message"},{default:(0,a.w5)((()=>[R])),_:1})]),1===n.form.userType?((0,a.wg)(),(0,a.iD)("p",{key:0,onClick:t[6]||(t[6]=e=>n.registerShow=!0),size:"large"},"注册成为动物医生")):(0,a.kq)("",!0),2===n.form.userType?((0,a.wg)(),(0,a.iD)("div",j,[(0,a.Wm)(X),E,(0,a._)("img",{src:n.form.vet["headImg"],alt:"头像"},null,8,L),(0,a._)("span",null,(0,l.zw)(n.form.vet["nickName"]),1),(0,a._)("span",null,(0,l.zw)(n.form.vet["vetDescribe"]),1),(0,a.Wm)(G,{class:"child",size:"17px",onClick:r.vetEdit},{default:(0,a.w5)((()=>[(0,a.Wm)(ie)])),_:1},8,["onClick"]),(0,a.Wm)(ee,{center:"",modelValue:n.vetDialog,"onUpdate:modelValue":t[9]||(t[9]=e=>n.vetDialog=e),title:"医生信息",width:"27%"},{footer:(0,a.w5)((()=>[(0,a.Wm)(K,{type:"warning",size:"small",onClick:r.update},{default:(0,a.w5)((()=>[H])),_:1},8,["onClick"]),(0,a.Wm)(K,{type:"warning",size:"small",plain:"",onClick:r.cancel},{default:(0,a.w5)((()=>[P])),_:1},8,["onClick"])])),default:(0,a.w5)((()=>[(0,a.Wm)(ne,{model:n.vet,size:"normal"},{default:(0,a.w5)((()=>[(0,a.Wm)(oe,{label:"昵称："},{default:(0,a.w5)((()=>[(0,a.Wm)(ae,{modelValue:n.vet.nickName,"onUpdate:modelValue":t[7]||(t[7]=e=>n.vet.nickName=e)},null,8,["modelValue"])])),_:1}),(0,a.Wm)(oe,{label:"描述："},{default:(0,a.w5)((()=>[(0,a.Wm)(ae,{modelValue:n.vet.vetDescribe,"onUpdate:modelValue":t[8]||(t[8]=e=>n.vet.vetDescribe=e),type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])):(0,a.kq)("",!0),n.registerShow?((0,a.wg)(),(0,a.j4)(re,{key:2,userId:n.form.id,onClose:r.close},null,8,["userId","onClose"])):(0,a.kq)("",!0)])):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(te,{class:"main-view",shadow:"never","body-style":"padding:0"},{default:(0,a.w5)((()=>[(0,a.Wm)(de)])),_:1})])),_:1})],64)}const G=e=>((0,a.dD)("data-v-1b8b1d63"),e=e(),(0,a.Cn)(),e),T=["src"],B=(0,a.Uk)("选择文件"),K=G((()=>(0,a._)("div",{class:"el-upload__tip text-red"}," 只能选择一个pdf文件，新的文件将覆盖旧文件 ",-1))),Q=(0,a.Uk)("提 交"),X=(0,a.Uk)("取 消");function ee(e,t,s,l,i,o){const n=(0,a.up)("el-input"),r=(0,a.up)("el-form-item"),d=(0,a.up)("Plus"),u=(0,a.up)("el-icon"),m=(0,a.up)("el-upload"),p=(0,a.up)("el-button"),c=(0,a.up)("el-form"),g=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.j4)(g,{modelValue:i.dialogFormVisible,"onUpdate:modelValue":t[2]||(t[2]=e=>i.dialogFormVisible=e),title:"动物医生注册表",width:"30%"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{ref:"vetFormRef",model:i.vetForm,rules:e.rules,"label-width":"100px",size:"normal",class:"demo-ruleForm"},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{label:"昵称",prop:"nickName",style:{width:"90%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:i.vetForm.nickName,"onUpdate:modelValue":t[0]||(t[0]=e=>i.vetForm.nickName=e),placeholder:"请输入昵称"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(r,{label:"描述",prop:"vetDescribe",style:{width:"90%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{modelValue:i.vetForm.vetDescribe,"onUpdate:modelValue":t[1]||(t[1]=e=>i.vetForm.vetDescribe=e),placeholder:"请输入您所擅长的方向，以及对它的详细描述",type:"textarea"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(r,{label:"头像"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"avatar-uploader",action:"http://120.79.190.143:9090/files/upload","show-file-list":!1,"on-success":o.handleAvatarSuccess,"before-upload":o.beforeAvatarUpload},{default:(0,a.w5)((()=>[i.imageUrl?((0,a.wg)(),(0,a.iD)("img",{key:0,src:i.vetForm.headImg,class:"avatar"},null,8,T)):((0,a.wg)(),(0,a.j4)(u,{key:1,class:"avatar-uploader-icon"},{default:(0,a.w5)((()=>[(0,a.Wm)(d)])),_:1}))])),_:1},8,["on-success","before-upload"])])),_:1}),(0,a.Wm)(r,{label:"证明文件"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{ref:"upload",class:"upload-demo",accept:"application/pdf",action:"http://120.79.190.143:9090/files/upload","before-upload":o.beforeFileUpload,limit:1,"on-exceed":o.handleExceed,"on-success":o.uploadSuccess,"auto-upload":!1},{trigger:(0,a.w5)((()=>[(0,a.Wm)(p,{type:"primary"},{default:(0,a.w5)((()=>[B])),_:1})])),tip:(0,a.w5)((()=>[K])),_:1},8,["before-upload","on-exceed","on-success"])])),_:1}),(0,a.Wm)(r,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"ml-3",type:"primary",onClick:o.submitUpload},{default:(0,a.w5)((()=>[Q])),_:1},8,["onClick"]),(0,a.Wm)(p,{onClick:o.cancel},{default:(0,a.w5)((()=>[X])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])}var te=s(4471),se=s(610),ae={name:"VetRegister",props:{userId:""},data(){return{dialogFormVisible:!0,vetForm:{},imageUrl:!1}},methods:{cancel(){this.$refs["upload"].clearFiles(),this.dialogFormVisible=!1,this.$emit("close",this.dialogFormVisible)},beforeAvatarUpload:e=>{let t=["image/jpeg","image/jpg","image/png"];const s=t.includes(e.type);return s?!(e.size/1024/1024>2)||(se.z8.error("图片大小不能超过2MB!"),!1):(se.z8.error("上传图片只能是 JPG、JPEG、PNG 格式!"),!1)},handleAvatarSuccess(e){this.vetForm.headImg=e.data,this.imageUrl=!0},uploadSuccess(e){this.vetForm.realInfo=e.data,this.vetForm.userId=this.userId;let t=this;this.$refs["vetFormRef"].validate((async e=>{e&&await te.Z.post("vet/register",this.vetForm).then((e=>{"0"===e.code?(this.$message({type:"success",message:"申请上传成功，请耐心等待审核结果"}),t.dialogFormVisible=!1):this.$message({type:"error",message:e.msg})}))}))},beforeFileUpload:e=>!(e.size/1024/1024>2)||(se.z8.error("文件大小不能超过2MB!"),!1),handleExceed(e){this.$refs["upload"].clearFiles();const t=e[0];t.uid=e[0].uid,this.$refs["upload"].handleStart(t)},submitUpload(){this.$refs["upload"].submit()}}},le=s(3744);const ie=(0,le.Z)(ae,[["render",ee],["__scopeId","data-v-1b8b1d63"]]);var oe=ie,ne={name:"UserInfo",data(){return{registerShow:!1,username:this.$store.getters.getUsername,form:JSON.parse(sessionStorage.getItem("user")),vet:{},attention:{},message:{},attentions:[],fans:[],attention_length:"",fan_length:"",userid:-1,isMe:!1,vetDialog:!1,isAttention:!1,showAttentions:!1,showFans:!1,toLetter:!1}},components:{VetRegister:oe},created(){this.userid=this.$route.query.userid?this.$route.query.userid:this.form.id,this.load(),this.getAttentions(),this.getFans()},methods:{close(e){this.registerShow=e},load(){this.form.id-this.userid===0&&(this.isMe=!0),!1===this.isMe&&(te.Z.get("/attention",{params:{userId:this.form.id,attentionId:this.userid}}).then((e=>{null!==e.data&&(this.attention=e.data,this.isAttention=!0)})),te.Z.get("/user/post/"+this.userid).then((e=>{this.form=e.data})))},getAttentions(){te.Z.get("/attention/"+this.userid).then((e=>{this.attentions=e.data,this.attention_length=e.data.length}))},getFans(){te.Z.get("/attention/fan/"+this.userid).then((e=>{this.fans=e.data,this.fan_length=e.data.length}))},toUser(e){this.$router.push({path:"/userinfo",query:{userid:e}}),setTimeout((function(){window.location.reload()}),1)},vetEdit(){this.vet=JSON.parse(JSON.stringify(this.form.vet)),this.vetDialog=!0},update(){te.Z.put("/vet",this.vet).then((e=>{"0"===e.code?(this.$message({type:"success",message:"修改成功"}),this.form.vet=this.vet,sessionStorage.setItem("user",JSON.stringify(this.form))):this.$message({type:"error",message:e.msg})})),this.vetDialog=!1},cancel(){this.vet={},this.vetDialog=!1},follow(){this.attention.userId=JSON.parse(sessionStorage.getItem("user")).id,this.attention.attentionId=this.userid,te.Z.post("/attention",this.attention).then((e=>{"0"===e.code?(this.$message({type:"success",message:"关注成功"}),this.isAttention=!0,this.fan_length+=1):this.$message({type:"error",message:e.msg})}))},async notFollow(){if(this.attention==={}){let e=JSON.parse(sessionStorage.getItem("user"));await te.Z.get("/attention",{params:{userId:e.id,attentionId:this.userid}}).then((e=>{this.attention=e.data}))}te.Z["delete"]("/attention/"+this.attention.id).then((e=>{"0"===e.code?(this.$message({type:"success",message:"取消关注成功"}),this.isAttention=!1,this.fan_length-=1):this.$message({type:"error",message:e.msg})}))},notFollowIt(e){te.Z["delete"]("/attention/"+e).then((e=>{"0"===e.code?(this.$message({type:"success",message:"取消关注成功"}),!0===this.showAttentions&&this.getAttentions(),!0===this.showFans&&this.getFans()):this.$message({type:"error",message:e.msg})}))},submit(){void 0!==this.message.content?(this.message.toId=this.userid,this.message.fromId=JSON.parse(sessionStorage.getItem("user")).id,this.message.time=this.getDate(),te.Z.post("/message",this.message).then((e=>{"0"===e.code?(this.$message({type:"success",message:"私信发送成功"}),this.message={},this.toLetter=!1):this.$message({type:"error",message:e.msg})}))):this.$message({type:"warning",message:"请输入内容"})},getDate(){const e=new Date,t=e.getFullYear(),s=e.getMonth()+1,a=e.getDate(),l=e.getHours(),i=e.getMinutes(),o=e.getSeconds(),n=t+"-"+this.convert(s)+"-"+this.convert(a)+" "+this.convert(l)+":"+this.convert(i)+":"+this.convert(o);return n},convert(e){return e<10?"0"+e:e}}};const re=(0,le.Z)(ne,[["render",Y],["__scopeId","data-v-e188cfea"]]);var de=re},5123:function(e,t,s){e.exports=s.p+"img/aclaw.68c5a9e1.png"},4198:function(e,t,s){e.exports=s.p+"img/aside_cat.2bdac686.png"},1517:function(e,t,s){e.exports=s.p+"img/cats.e1a0705e.png"},1074:function(e,t,s){e.exports=s.p+"img/claw.17322a75.png"}}]);
//# sourceMappingURL=209.dbad7b18.js.map